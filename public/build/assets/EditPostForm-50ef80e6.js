import{W as U,R as c,j as e,u as V}from"./app-efa55958.js";import{P as q}from"./PrimaryButton-63ebb02b.js";import{P as W,F as N}from"./FileUpload-8df4bbf1.js";import{C as K}from"./ContentEditor-3e62ebb7.js";import{C as Q}from"./MultiSelect-4c8dfdbf.js";import{Q as F}from"./chunk-SK7D2XJH-8c4bbfe6.js";import{I as $,a as H,C as J}from"./chunk-BTVB6U66-8a1064af.js";import{F as X}from"./index.esm-e20009f6.js";import{u as Y}from"./chunk-5LTIYV3A-a216305e.js";import{G as Z}from"./chunk-JARCRF6W-6766cdec.js";import{G as I}from"./chunk-ZPFGWTBB-5ba3fc59.js";import{V as C}from"./chunk-NTCQBYKE-db626ce2.js";import{F as n,I as m}from"./chunk-6CVSDS6C-e8322ee8.js";import{F as o}from"./chunk-GCOAS5YC-b63ccf93.js";import{F as d}from"./chunk-5ZQ6B3SW-100d0584.js";import{T as k}from"./chunk-4IH3O7BJ-322ca07b.js";import{A as D,a as ee,b as te,c as ie,d as re}from"./chunk-CRBMUVJA-dd564ac7.js";import{B as w}from"./chunk-PULVB27S-076b392b.js";import{T}from"./chunk-KICXRNWJ-a026dd73.js";import{S as R}from"./chunk-3RSXBRAN-bbea2ba3.js";import{S as le}from"./chunk-ZHMYA64R-2b67766a.js";import{R as se}from"./chunk-RDF2AYID-f379ce17.js";import{B as ae}from"./chunk-UVUR7MCU-f950a53f.js";import{I as ne}from"./chunk-FKYN3ZGE-f31ed73d.js";import"./chunk-KRPLQIP4-2070ff1c.js";import"./chunk-7OLJDQMT-7f99fc6b.js";import"./chunk-2OOHT3W5-8a8b58d4.js";import"./chunk-R3DH46PF-f0689d26.js";import"./chunk-QINAG4RG-420d55bb.js";import"./chunk-SPIKMR6I-154a1106.js";import"./index-7ad6ff22.js";import"./defineProperty-0e4f3c13.js";import"./createSuper-0a89e92d.js";import"./objectWithoutPropertiesLoose-4f48578a.js";import"./chunk-KC77MHL3-45b95fd3.js";import"./chunk-G72KV6MB-dbbc8cf4.js";import"./chunk-57I6FYPZ-4990f36c.js";import"./chunk-W7WUSNWJ-1d37fd26.js";import"./chunk-UZJ3TPNQ-b2d78fd3.js";import"./chunk-OCNORRQU-3e952216.js";import"./chunk-ROURZMX4-1c85f1b1.js";import"./chunk-3XANSPY5-cf37bc50.js";import"./index-ba18a0bd.js";import"./index-01a9cce7.js";import"./index-4647d92d.js";import"./chunk-DEQZ7DVA-e22fe2bd.js";import"./iconBase-93c9f5ca.js";import"./chunk-RKXMPHPI-3dbbc512.js";import"./chunk-6NHXDBFO-987cde81.js";import"./index-979d1106.js";function oe(r,p){let u=[];return u=r.filter(h=>!p.find(l=>l.id===h.id)),u}function st({post:r,categories:p,tags:u,themes:h}){const{data:l,setData:s,post:A,processing:E,errors:i}=U({title:r.title,category_id:r.category_id,theme_id:r.theme_id,content:r.content,excerpt:r.excerpt,status:r.status,author:r.author,image:r.media.filter(t=>t.collection_name==="post-featured-image")[0],file:r.media.filter(t=>t.collection_name==="post-media")[0],link:r.link,genre:r.genre,published_at:r.published_at,meta_title:r.meta_title,meta_description:r.meta_description});console.log(r);const z=Y(),[g,b]=c.useState(l.image?l.image.preview_url:null),[v,y]=c.useState(l.file?l.file.file_name:null),[x,P]=c.useState(r.slug),[j,S]=c.useState(()=>{let t=[];return r.tags.map(a=>{t.push({value:a.id,label:a.name})}),t}),[O,B]=c.useState([]);function L(t){let a=[];S(t),t.forEach(_=>a.push({tag_id:_.value,post_id:r.id})),s("tags",a)}const[f,M]=c.useState(p.filter(t=>t.id==l.category_id)[0].name);c.useEffect(()=>{l.title&&(P(l.title.toLowerCase().replace(/\s+/g,"-").replaceAll(",","")),s("slug",x))},[l.title]),c.useEffect(()=>{s("slug",x)},[x]),c.useEffect(()=>{if(j&&u){const t=oe(u,j);if(t.length>0){let a=[];t.map(_=>{a.push({value:_.id,label:_.name})}),B([...a])}}},[j,u]);const G=t=>{t.preventDefault(),A(route("admin.posts.update",{_method:"patch",post:r.id}),{preserveScroll:!0,onSuccess:()=>z({position:"top-right",title:"Post edited.",description:"Post edited Successfully",status:"success",duration:6e3,isClosable:!0}),onError:a=>console.error(`Something went wrong: ${a}`)})};return e.jsx("form",{onSubmit:G,children:e.jsxs(Z,{templateColumns:{base:"1fr",xl:"repeat(7, minmax(auto, 1fr))"},gap:8,children:[e.jsx(I,{colSpan:{base:1,lg:5},children:e.jsxs(C,{spacing:8,align:"start",children:[e.jsxs(n,{isInvalid:i.title,isRequired:!0,children:[e.jsx(o,{htmlFor:"title",children:"Title"}),e.jsx(m,{type:"text",id:"title",name:"title",display:"block",mt:1,value:l.title,autoComplete:"title",onChange:t=>s("title",t.target.value)}),i.name&&e.jsx(d,{mt:2,children:i.name})]}),e.jsxs(n,{children:[e.jsx(o,{htmlFor:"slug",children:"Slug"}),e.jsx(m,{type:"text",id:"slug",isReadOnly:!0,name:"slug",color:V("blue.600","blue.300"),value:x,display:"flex",mt:1})]}),e.jsxs(n,{mt:4,isInvalid:i.content,children:[e.jsx(o,{htmlFor:"content",children:"Content"}),e.jsx(K,{id:"content",name:"content",type:"classic",initialValue:r.content,onChange:(t,a)=>{s("content",a.getContent())}}),i.content&&e.jsx(d,{mt:2,children:i.content})]}),e.jsxs(n,{isInvalid:i.excerpt,children:[e.jsx(o,{htmlFor:"excerpt",children:"Excerpt/Short Description"}),e.jsx(k,{id:"excerpt",isInvalid:i.excerpt,resize:"vertical",name:"excerpt",display:"flex",rows:6,defaultValue:r.excerpt,mt:1,onChange:t=>s("excerpt",t.target.value)}),i.excerpt&&e.jsx(d,{mt:2,children:i.excerpt})]})]})}),e.jsx(I,{colSpan:{base:1,lg:2},children:e.jsxs(C,{spacing:8,children:[e.jsx(D,{allowToggle:!0,w:"full",children:e.jsxs(ee,{children:[e.jsx("h2",{children:e.jsxs(te,{_expanded:{bg:"gray.600",color:"white"},children:[e.jsxs(w,{as:"span",flex:"1",textAlign:"left",fontWeight:"semibold",children:["SEO Meta Tags ",e.jsx(T,{label:"Add title and description for SEO",fontSize:"xs",children:e.jsx(F,{boxSize:3})})]}),e.jsx(ie,{})]})}),e.jsx(re,{pb:4,children:e.jsxs(C,{gap:"6",alignItems:"start",children:[e.jsxs(n,{mt:"4",isInvalid:i.meta_title,children:[e.jsx(o,{htmlFor:"meta_title",children:"Meta Title"}),e.jsx(m,{id:"meta_title",name:"meta_title",placeholder:"enter meta title",value:l.meta_title,onChange:t=>s("meta_title",t.target.value)}),e.jsx(d,{message:i.meta_title,className:"mt-2"})]}),e.jsxs(n,{mt:"4",isInvalid:i.meta_description,children:[e.jsx(o,{htmlFor:"meta_description",children:"Meta Description"}),e.jsx(k,{id:"meta_description",name:"meta_description",placeholder:"enter meta_description",value:l.meta_description,rows:3,resize:"vertical",onChange:t=>s("meta_description",t.target.value)}),e.jsx(d,{message:i.meta_description,className:"mt-2"})]})]})})]})}),e.jsxs(n,{isRequired:!0,as:"fieldset",children:[e.jsx(o,{as:"legend",htmlFor:"category_id",children:"Category"}),e.jsx(R,{name:"category_id",id:"category_id",placeholder:"Select Category",value:l.category_id,onChange:t=>{s("category_id",t.target.value),M(p.filter(a=>a.id==t.target.value)[0].name)},children:p&&p.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))})]}),e.jsxs(n,{isInvalid:i.published_at,isRequired:!0,children:[e.jsx(o,{as:"legend",htmlFor:"published_at",children:"Published At"}),e.jsx(m,{type:"datetime-local",id:"published_at",name:"published_at",value:l.published_at,onChange:t=>s("published_at",t.target.value)}),i.published_at&&e.jsx(d,{mt:2,children:i.published_at})]}),f!=="Covid"&&e.jsxs(n,{isInvalid:i.theme_id,as:"fieldset",children:[e.jsx(o,{as:"legend",htmlFor:"theme_id",children:"Theme"}),e.jsx(R,{name:"theme_id",placeholder:"Select theme",value:l.theme_id,onChange:t=>{s("theme_id",t.target.value)},children:h&&h.map(t=>e.jsx("option",{value:t.id,children:t.title},t.id))}),i.theme_id&&e.jsx(d,{mt:2,children:i.theme_id})]}),f!=="Covid"&&e.jsxs(n,{py:4,id:"tags",children:[e.jsx(o,{htmlFor:"tags",children:" Add Tags"}),e.jsx(Q,{isMulti:!0,name:"tags",options:O,variant:"filled",tagVariant:"solid",placeholder:"Select Tags",value:j,onChange:t=>{S(t),L(t)},selectedOptionColorScheme:"blue"})]}),e.jsxs(n,{mt:4,isInvalid:i.status,isRequired:!0,children:[e.jsx(o,{htmlFor:"status",children:"Status"}),e.jsx(le,{direction:"row",flexWrap:"wrap",spacing:[4,6],children:["unpublished","draft","published"].map(t=>e.jsx(se,{name:"status",isChecked:l.status===t,value:t,onChange:a=>{s("status",a.target.value)},children:t},t))}),i.status&&e.jsx(d,{mt:2,children:i.status})]}),e.jsxs(n,{isInvalid:i.author,mt:4,children:[e.jsxs(o,{htmlFor:"name",children:["Author/s ",e.jsx(T,{label:"Add author name, if multple authors use comma seperated format. Eg: Paras Kharel, Dikshya Singh, Kshitiz Dahal",fontSize:"xs",float:"right",children:e.jsx(F,{boxSize:3})})]}),e.jsx(m,{type:"text",id:"author",name:"author",display:"block",w:"full",mt:1,autoComplete:"author",value:l.author,onChange:t=>s("author",t.target.value)}),i.author&&e.jsx(d,{mt:2,children:i.author})]}),f==="Covid"&&e.jsxs(n,{isInvalid:i.genre,mt:4,children:[e.jsx(o,{htmlFor:"genre",children:"Genre"}),e.jsx(m,{type:"text",id:"genre",name:"genre",display:"block",w:"full",mt:1,autoComplete:"genre",onChange:t=>s("genre",t.target.value)}),i.genre&&e.jsx(d,{mt:2,children:i.genre})]}),f==="Covid"&&e.jsxs(n,{isInvalid:i.link,isRequired:!0,mt:4,children:[e.jsx(o,{htmlFor:"link",children:"External Link"}),e.jsx(m,{type:"text",id:"link",name:"link",display:"block",w:"full",mt:1,value:l.link,autoComplete:"link",onChange:t=>s("link",t.target.value)}),i.link&&e.jsx(d,{mt:2,children:i.link})]}),e.jsxs(n,{mt:4,children:[e.jsx(o,{htmlFor:"image",children:"Featured Image"}),g&&e.jsxs(e.Fragment,{children:[e.jsx(W,{id:"preview_image",src:(r.featured_image,g)}),e.jsx(ae,{mt:4,size:"sm",colorScheme:"red",onClick:()=>{b(null)},children:"Change Image"})]}),!g&&e.jsx(N,{accept:"image/.png,.jpg,.jpeg,.webp",children:e.jsx(m,{type:"file",multiple:!0,height:"100%",width:"100%",position:"absolute",top:"0",left:"0",opacity:"0","aria-hidden":"true",accept:"image/.png,.jpg,.jpeg,.webp",id:"image",name:"image",size:"md",onChange:t=>{s("image",t.target.files[0]),b(URL.createObjectURL(t.target.files[0]))}})})]}),e.jsxs(n,{mt:4,children:[e.jsx(o,{htmlFor:"file",children:"File Upload"}),e.jsx(e.Fragment,{children:e.jsxs(ne,{children:[e.jsx($,{children:e.jsx(X,{})}),e.jsxs(w,{position:"relative",children:[e.jsx(m,{size:"md",isReadOnly:!0,placeholder:v||"No file selected"}),e.jsx(m,{type:"file",height:"100%",width:"100%",position:"absolute",top:"0",left:"0",opacity:"0","aria-hidden":"true",accept:".pdf,.doc,.docx,.ppt,.pptx",id:"file",name:"file",size:"md",onChange:t=>{y(t.target.files[0].name),s("file",t.target.files[0])}})]}),v&&e.jsx(H,{children:e.jsx(J,{color:"red.500",onClick:()=>{y(null)}})})]})})]}),e.jsx(q,{type:"submit",isLoading:E,w:"md",maxW:"full",children:"Save"})]})})]})})}export{st as default};
